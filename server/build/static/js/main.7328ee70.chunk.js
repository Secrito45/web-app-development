(this["webpackJsonpno-name"]=this["webpackJsonpno-name"]||[]).push([[0],{41:function(e,t,n){"use strict";n.r(t);var c=n(16),i=n.n(c),r=n(5),a=n.n(r),s=n(6),o=n(2),l=n(1),u=n(4),j=n.n(u),b={login:function(){var e=Object(s.a)(a.a.mark((function e(t){var n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j.a.post("http://localhost:3001/api/login",t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},d=n(0),h=function(e){var t=e.initial,n=e.headerLabel,c=e.handleAction,i=e.handleClose,r=Object(l.useState)(t?t.method:""),a=Object(o.a)(r,2),s=a[0],u=a[1],j=Object(l.useState)(t&&t.ingredients?t.ingredients:["","",""]),b=Object(o.a)(j,2),h=b[0],O=b[1],p=Object(l.useState)(t?t.name:""),x=Object(o.a)(p,2),f=x[0],m=x[1],v=Object(l.useState)(t?t.url:""),g=Object(o.a)(v,2),k=g[0],C=g[1],S=function(e){var t=[];return e.forEach((function(e){""!==e&&t.push(e)})),t},w=function(e){O(h.map((function(t,n){return n!==Number(e.target.id)?t:e.target.value})))},y=function(e){switch(e.target.name){case"method":u(e.target.value);break;case"name":m(e.target.value);break;case"url":C(e.target.value)}},L=function(e){"add"===e?O(h.concat("")):"drop"===e&&O(h.slice(0,h.length-1))};return Object(d.jsxs)("form",{onSubmit:function(e){if(e.preventDefault(),""!==f){var n={id:t?t.id:void 0,url:k,name:f,method:s,ingredients:S(h)};c(n),u(""),O(["","",""]),m(""),i(n)}else alert("Reseptill\xe4 t\xe4ytyy olla nimi!")},children:[Object(d.jsx)("h3",{children:n}),Object(d.jsx)("p",{children:"Reseptin nimi"}),Object(d.jsx)("input",{value:f,name:"name",onChange:y})," ",Object(d.jsx)("br",{}),Object(d.jsx)("p",{children:"Raaka-aineet"}),Object(d.jsx)("button",{type:"button",onClick:function(){return L("add")},children:"Lis\xe4\xe4 uusi kentt\xe4"}),Object(d.jsx)("button",{type:"button",onClick:function(){return L("drop")},children:"Poista kentt\xe4"})," ",Object(d.jsx)("br",{}),Object(d.jsx)("br",{}),h.map((function(e,t){return Object(d.jsxs)("div",{children:[t+1,Object(d.jsx)("input",{value:e,id:t,onChange:w})," ",Object(d.jsx)("br",{})]},t)})),Object(d.jsx)("p",{children:"Valmistusohje"}),Object(d.jsx)("textarea",{value:s,name:"method",onChange:y})," ",Object(d.jsx)("br",{}),Object(d.jsx)("p",{children:"Lis\xe4\xe4 linkki ohjeenseen"}),Object(d.jsx)("input",{value:k,name:"url",onChange:y})," ",Object(d.jsx)("br",{})," ",Object(d.jsx)("br",{}),Object(d.jsx)("button",{type:"submit",children:"Tallenna"})]})},O=function(e){var t=e.item,n=e.handleAction,c=e.handleDelete,i=Object(l.useState)(t),r=Object(o.a)(i,2),a=r[0],s=r[1],u=Object(l.useState)(!1),j=Object(o.a)(u,2),b=j[0],O=j[1];return b?Object(d.jsx)("div",{children:Object(d.jsx)(h,{initial:a,headerLabel:"Reseptin muokkaus",handleAction:n,handleClose:function(e){s(e),O(!1)}})}):(console.log(a.ingredients),a.ingredients&&a.ingredients.length>0?Object(d.jsxs)("div",{children:[Object(d.jsx)("h1",{children:a.name}),Object(d.jsx)("h2",{children:"Raaka-aineet"}),Object(d.jsx)("ul",{children:a.ingredients.map((function(e,t){return Object(d.jsx)("li",{children:e},t)}))}),Object(d.jsx)("h2",{children:"Valmistusohje"}),Object(d.jsx)("p",{children:a.method}),Object(d.jsx)("button",{onClick:function(){return O(!0)},children:"Muokkaa"}),Object(d.jsx)("button",{onClick:function(){return c(a.id)},children:"Poista resepti"})]}):a.url?Object(d.jsxs)("div",{children:[Object(d.jsx)("h1",{children:a.name}),Object(d.jsx)("h2",{children:"Linkki kolmannenosapuolen ohjeeseen"}),Object(d.jsx)("a",{href:a.url,children:Object(d.jsx)("p",{children:"Linkki ulkoiseen ohjeeseen"})}),Object(d.jsx)("button",{onClick:function(){return O(!0)},children:"Muokkaa"}),Object(d.jsx)("button",{onClick:function(){return c(a.id)},children:"Poista resepti"})]}):Object(d.jsxs)("div",{children:[Object(d.jsx)("h1",{children:a.name}),Object(d.jsx)("h2",{children:"Raaka-aineet"}),Object(d.jsx)("p",{children:"Ei saatavilla"}),Object(d.jsx)("h2",{children:"Valmistusohje"}),Object(d.jsx)("p",{children:"Ei saatavilla"}),Object(d.jsx)("h2",{children:"Linkki kolmannenosapuolen ohjeeseen"}),Object(d.jsx)("p",{children:" Ei saatavilla "}),Object(d.jsx)("button",{onClick:function(){return O(!0)},children:"Muokkaa"}),Object(d.jsx)("button",{onClick:function(){return c(a.id)},children:"Poista resepti"})]}))},p=function(e){var t=e.item,n=e.handleClick;return Object(d.jsx)("li",{children:Object(d.jsx)("button",{onClick:function(){n(t)},children:t.name})})},x=function(e){var t=Object(l.useState)([]),n=Object(o.a)(t,2),c=n[0],i=n[1],r=Object(l.useState)(!1),u=Object(o.a)(r,2),x=u[0],f=u[1],m=Object(l.useState)(!1),v=Object(o.a)(m,2),g=v[0],k=v[1],C=Object(l.useState)(),S=Object(o.a)(C,2),w=S[0],y=S[1],L=Object(l.useState)(""),A=Object(o.a)(L,2),E=A[0],R=A[1],P=Object(l.useState)(""),D=Object(o.a)(P,2),I=D[0],J=D[1],K=Object(l.useState)(null),N=Object(o.a)(K,2),T=N[0],z=N[1],M="http://localhost:3001";Object(l.useEffect)((function(){if(console.log("App Component Effect"),null!==T){var e={headers:{Authorization:"bearer ".concat(T.token)}};j.a.get(M+"/api/recipes",e).then((function(e){console.log("Promise fulfilled"),i(e.data)})).catch((function(e){console.error("Failed to retrieve recipes:",e.message)}))}else console.log("No user logged in")}),[T]),Object(l.useEffect)((function(){var e=window.localStorage.getItem("loggedUser");if(e){var t=JSON.parse(e);z(t)}}),[]),console.log("Render "+c.length+" recipes");var U=function(){var e=Object(s.a)(a.a.mark((function e(t){var n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.prev=1,e.next=4,b.login({username:E,password:I});case 4:n=e.sent,window.localStorage.setItem("loggedUser",JSON.stringify(n)),z(n),R(""),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(1),console.log("Trying to login with",E,I),alert("Wrong credentials");case 14:J("");case 15:case"end":return e.stop()}}),e,null,[[1,10]])})));return function(t){return e.apply(this,arguments)}}(),V=function(e){y(e),k(!0)};return null===T?Object(d.jsxs)("div",{children:[Object(d.jsx)("h2",{children:"Kirjaudu sis\xe4\xe4n palveluun"}),Object(d.jsxs)("form",{onSubmit:U,children:[Object(d.jsxs)("div",{children:["K\xe4ytt\xe4j\xe4",Object(d.jsx)("input",{type:"text",value:E,name:"username",onChange:function(e){var t=e.target;return R(t.value)}})]}),Object(d.jsxs)("div",{children:["Salasana",Object(d.jsx)("input",{type:"password",value:I,name:"password",onChange:function(e){var t=e.target;return J(t.value)}})]}),Object(d.jsx)("button",{type:"submit",children:"Kirjaudu sis\xe4\xe4n"})]})]}):x?Object(d.jsxs)("div",{children:[Object(d.jsx)("button",{onClick:function(){return f(!1)},children:"Takaisin"}),Object(d.jsx)(h,{headerLabel:"Lis\xe4\xe4 uusi resepti",handleAction:function(e){var t={headers:{Authorization:"bearer ".concat(T.token)}};console.log(e),j.a.post(M+"/api/recipes",e,t).then((function(e){var t=e.data;console.log(t),i(c.concat(t))}))},handleClose:function(){return f(!1)}})]}):g?Object(d.jsxs)("div",{children:[Object(d.jsx)("button",{onClick:function(){return k(!1)},children:"Takaisin"}),Object(d.jsx)(O,{item:w,handleAction:function(e){var t={headers:{Authorization:"bearer ".concat(T.token)}},n=e.id;j.a.put(M+"/api/recipes/"+n,e,t).then((function(t){console.log(t.data),i(c.map((function(t){return t.id!==n?t:e})))}))},handleClose:function(){return k(!1)},handleDelete:function(e){j.a.delete(M+"/api/recipes/"+e).then((function(t){i(c.filter((function(t){return t.id!==e}))),k(!1)}))}})]}):Object(d.jsxs)("div",{children:[Object(d.jsx)("h1",{children:"Reseptikirja"}),Object(d.jsx)("ul",{children:c.map((function(e){return Object(d.jsx)(p,{item:e,handleClick:V},e.id)}))}),Object(d.jsx)("button",{onClick:function(){return f(!0)},children:"Luo uusi resepti"}),Object(d.jsx)("br",{}),Object(d.jsx)("br",{}),Object(d.jsx)("button",{onClick:function(){window.localStorage.removeItem("loggedUser"),z(null),i([])},children:"Kirjaudu ulos"})]})};i.a.render(Object(d.jsx)(x,{}),document.getElementById("root"))}},[[41,1,2]]]);
//# sourceMappingURL=main.7328ee70.chunk.js.map